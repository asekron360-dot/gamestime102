<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Clean Master Privacy – Tek Sayfalık Antivirüs</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- GitHub Pages için CSP (self + CDN) -->
<meta http-equiv="Content-Security-Policy"
      content="default-src 'self'; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://code.jquery.com; img-src 'self' data:;">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM"
      crossorigin="anonymous">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous">

<style>
:root{
  --primary:#6c5ce7;--secondary:#a29bfe;--dark:#2d3436;--light:#dfe6e9;
}
[data-theme="dark"]{--primary:#a29bfe;--secondary:#6c5ce7;--dark:#dfe6e9;--light:#2d3436;}
body{font-family:Arial,sans-serif;background:#f5f5f5;color:var(--dark);}
.navbar{background:#333;}
.page-section{display:none;padding:2rem;}
.page-section.active{display:block;}
.file-drop{border:2px dashed #bbb;padding:2rem;text-align:center;cursor:pointer;}
.file-drop.dragover{border-color:var(--primary);background:#fafafa;}
.toast{position:fixed;top:1rem;right:1rem;min-width:250px;}
</style>
</head>
<body data-theme="light">

<nav class="navbar navbar-expand-lg navbar-dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="#"><i class="fas fa-shield-alt"></i> Clean Master Privacy</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
            data-bs-target="#navMenu"><span class="navbar-toggler-icon"></span></button>
    <div class="collapse navbar-collapse" id="navMenu">
      <ul class="navbar-nav me-auto">
        <li class="nav-item"><a class="nav-link active" href="#" data-page="home">Ana Sayfa</a></li>
        <li class="nav-item"><a class="nav-link" href="#" data-page="scan">Tarama</a></li>
        <li class="nav-item"><a class="nav-link" href="#" data-page="settings">Ayarlar</a></li>
      </ul>
      <button class="btn btn-outline-light" id="themeToggle"><i class="fas fa-moon"></i></button>
    </div>
  </div>
</nav>

<div class="container my-4">

  <!-- HOME -->
  <section id="home" class="page-section active">
    <h2>Hoşgeldiniz</h2>
    <p>Antivirüs hizmetimizi kullanmak için <strong>Proton Mail</strong> hesabınızla giriş yapmanız gerekir.</p>

    <form id="loginForm" class="row g-3 needs-validation" novalidate>
      <div class="col-md-6">
        <label for="protonEmail" class="form-label">Proton Mail adresi</label>
        <input type="email" class="form-control" id="protonEmail" placeholder="you@protonmail.com" required>
        <div class="invalid-feedback">Geçerli bir e‑posta girin.</div>
      </div>
      <div class="col-md-6">
        <label for="protonPass" class="form-label">Parola</label>
        <input type="password" class="form-control" id="protonPass" required>
        <div class="invalid-feedback">Parola gerekli.</div>
      </div>
      <div class="col-12">
        <button type="submit" class="btn btn-primary"><i class="fas fa-sign-in-alt"></i> Giriş Yap</button>
      </div>
    </form>
  </section>

  <!-- SCAN -->
  <section id="scan" class="page-section">
    <h2>Dosya Tarama</h2>
    <div class="file-drop" id="dropZone">
      <i class="fas fa-cloud-upload-alt fa-2x mb-2"></i><br>
      Dosyaları sürükleyip bırakın veya tıklayın
      <input type="file" id="fileInput" multiple class="d-none" accept=".pdf,.docx,.txt,.jpg,.png,.exe,.zip">
    </div>
    <div id="fileList" class="mt-3"></div>
    <button id="scanBtn" class="btn btn-success mt-3" disabled><i class="fas fa-search"></i> Tarama Başlat</button>

    <div id="resultArea" class="mt-4"></div>
  </section>

  <!-- SETTINGS -->
  <section id="settings" class="page-section">
    <h2>Ayarlar</h2>
    <div class="form-check form-switch mb-3">
      <input class="form-check-input" type="checkbox" id="autoUploadSwitch" checked>
      <label class="form-check-label" for="autoUploadSwitch">Tarama sonuçlarını Proton Drive’a otomatik kaydet</label>
    </div>
    <button id="saveSettings" class="btn btn-primary">Kaydet</button>
  </section>
</div>

<!-- TOAST -->
<div class="toast align-items-center text-bg-primary border-0" id="toastMsg">
  <div class="d-flex">
    <div class="toast-body" id="toastBody"></div>
    <button type="button" class="btn-close btn-close-white me-2 m-auto"
            data-bs-dismiss="toast"></button>
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.7.0.min.js"
        integrity="sha256-3gJwYp+Z5Y6V4J+L/2j8KJp2K5Z5+5R5j5J5U5V5U5U="
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+2V5x5x5x5x5x5x5x5x5x5x5x5x5x5x5"
        crossorigin="anonymous"></script>

<script>
// ---------- Tema ----------
document.getElementById('themeToggle').addEventListener('click',()=> {
  const cur = document.body.dataset.theme;
  document.body.dataset.theme = cur==='light'?'dark':'light';
});

// ---------- Sayfa Geçiş ----------
document.querySelectorAll('[data-page]').forEach(link=>{
  link.addEventListener('click',e=>{
    e.preventDefault();
    const target = e.target.dataset.page;
    document.querySelectorAll('.page-section').forEach(s=>s.classList.remove('active'));
    document.getElementById(target).classList.add('active');
    document.querySelectorAll('.nav-link').forEach(l=>l.classList.remove('active'));
    e.target.classList.add('active');
  });
});

// ---------- Giriş ----------
let loggedInUser = null;
document.getElementById('loginForm').addEventListener('submit',e=>{
  e.preventDefault();
  const email=document.getElementById('protonEmail').value.trim();
  const pass=document.getElementById('protonPass').value;
  // Basit mock doğrulama – gerçek dünyada OAuth / Proton API kullanılmalı
  if(email.endsWith('@protonmail.com') && pass.length>=6){
    loggedInUser=email;
    showToast('Giriş başarılı! Tarama sayfasına yönlendiriliyorsunuz.');
    setTimeout(()=>{document.querySelector('[data-page="scan"]').click();},1500);
  }else{
    showToast('Geçersiz Proton Mail kimlik bilgileri.', 'danger');
  }
});

// ---------- Dosya Yükleme ----------
const dropZone=document.getElementById('dropZone');
const fileInput=document.getElementById('fileInput');
let selectedFiles=[];

dropZone.addEventListener('click',()=>fileInput.click());
dropZone.addEventListener('dragover',e=>{e.preventDefault();dropZone.classList.add('dragover');});
dropZone.addEventListener('dragleave',()=>dropZone.classList.remove('dragover'));
dropZone.addEventListener('drop',e=>{
  e.preventDefault();dropZone.classList.remove('dragover');
  handleFiles(e.dataTransfer.files);
});
fileInput.addEventListener('change',()=>handleFiles(fileInput.files));

function handleFiles(files){
  selectedFiles=[...files];
  const list=document.getElementById('fileList');
  list.innerHTML='';
  selectedFiles.forEach(f=>{list.innerHTML+=`<div>${f.name} (${(f.size/1024).toFixed(1)} KB)</div>`;});
  document.getElementById('scanBtn').disabled=!selectedFiles.length;
}

// ---------- Virüs Veri Tabanı (embedded) ----------
const virusDB=[
  {"id":"trojan-001","name":"FakeTrojan","hash":"a1b2c3d4e5f67890abcdef1234567890"},
  {"id":"ransomware-007","name":"CryptoLock","hash":"11223344556677889900aabbccddeeff"}
];

// ---------- Tarama ----------
document.getElementById('scanBtn').addEventListener('click',async()=>{
  if(!loggedInUser){showToast('Önce giriş yapmalısınız.', 'warning');return;}
  const resultDiv=document.getElementById('resultArea');
  resultDiv.innerHTML='<p>Tarama yapılıyor…</p>';
  const reports=[];
  for(const f of selectedFiles){
    const buf=await f.arrayBuffer();
    const hashBuf=await crypto.subtle.digest('SHA-256',buf);
    const hashArr=Array.from(new Uint8Array(hashBuf));
    const hashHex=hashArr.map(b=>b.toString(16).padStart(2,'0')).join('');
    const match=virusDB.find(v=>v.hash===hashHex);
    const status=match ? `Tehlikeli (${match.name})` : 'Güvenli';
    reports.push({file:f.name,hash:hashHex,status});
  }
  // Sonuçları ekrana yazdır
  let html='<h4>Tarama Sonuçları</h4><ul class="list-group">';
  reports.forEach(r=>{html+=`<li class="list-group-item d-flex justify-content-between align-items-center">
        ${r.file}<span class="${r.status.startsWith('Tehlikeli')?'text-danger':'text-success'}">${r.status}</span></li>`;});
  html+='</ul>';
  resultDiv.innerHTML=html;

  // Otomatik Drive kaydet (mock)
  if(document.getElementById('autoUploadSwitch').checked){
    mockUploadToDrive(reports);
  }
});

// ---------- Mock Proton Drive Upload ----------
function mockUploadToDrive(report){
  // Gerçek entegrasyon için Proton Drive API + OAuth gerekir.
  // Burada sadece bir toast gösteriyoruz.
  showToast('Rapor Proton Drive’a kaydedildi (mock).');
}

// ---------- Toast ----------
function showToast(msg,type='primary'){
  const toastEl=document.getElementById('toastMsg');
  const body=document.getElementById('toastBody');
  body.textContent=msg;
  toastEl.className=`toast align-items-center text-bg-${type} border-0`;
  const bsToast=new bootstrap.Toast(toastEl,{delay:4000});
  bsToast.show();
}

// ---------- Ayarları Kaydet ----------
document.getElementById('saveSettings').addEventListener('click',()=>{
  const auto=document.getElementById('autoUploadSwitch').checked;
  localStorage.setItem('autoUpload',auto);
  showToast('Ayarlar kaydedildi.');
});
// Sayfa yüklendiğinde ayarları oku
window.addEventListener('load',()=>{
  const auto=localStorage.getItem('autoUpload');
  if(auto!==null) document.getElementById('autoUploadSwitch').checked=(auto==='true');
});
</script>
</body>
</html>
